// card@2.5.4 downloaded from https://ga.jspm.io/npm:card@2.5.4/lib/card.js

import a from"./card.css";import*as r from"qj";import*as t from"payment";import*as i from"node.extend";var e="default"in r?r.default:r;var n="default"in t?t.default:t;var s="default"in i?i.default:i;var d="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var l={};(function(){var r,t,i,bind=function(a,r){return function(){return a.apply(r,arguments)}};a;t=e;n;i=s;r=function(){var a,r;Card.prototype.initializedDataAttr="data-jp-card-initialized";Card.prototype.cardTemplate='<div class="jp-card-container"><div class="jp-card"><div class="jp-card-front"><div class="jp-card-logo jp-card-elo"><div class="e">e</div><div class="l">l</div><div class="o">o</div></div><div class="jp-card-logo jp-card-visa">Visa</div><div class="jp-card-logo jp-card-visaelectron">Visa<div class="elec">Electron</div></div><div class="jp-card-logo jp-card-mastercard">Mastercard</div><div class="jp-card-logo jp-card-maestro">Maestro</div><div class="jp-card-logo jp-card-amex"></div><div class="jp-card-logo jp-card-discover">discover</div><div class="jp-card-logo jp-card-unionpay">UnionPay</div><div class="jp-card-logo jp-card-dinersclub"></div><div class="jp-card-logo jp-card-hipercard">Hipercard</div><div class="jp-card-logo jp-card-troy">troy</div><div class="jp-card-logo jp-card-dankort"><div class="dk"><div class="d"></div><div class="k"></div></div></div><div class="jp-card-logo jp-card-jcb"><div class="j">J</div><div class="c">C</div><div class="b">B</div></div><div class="jp-card-lower"><div class="jp-card-shiny"></div><div class="jp-card-cvc jp-card-display">{{cvc}}</div><div class="jp-card-number jp-card-display">{{number}}</div><div class="jp-card-name jp-card-display">{{name}}</div><div class="jp-card-expiry jp-card-display" data-before="{{monthYear}}" data-after="{{validDate}}">{{expiry}}</div></div></div><div class="jp-card-back"><div class="jp-card-bar"></div><div class="jp-card-cvc jp-card-display">{{cvc}}</div><div class="jp-card-shiny"></div></div></div></div>';Card.prototype.template=function(a,r){return a.replace(/\{\{(.*?)\}\}/g,(function(a,t,i){return r[t]}))};Card.prototype.cardTypes=["jp-card-amex","jp-card-dankort","jp-card-dinersclub","jp-card-discover","jp-card-unionpay","jp-card-jcb","jp-card-laser","jp-card-maestro","jp-card-mastercard","jp-card-troy","jp-card-unionpay","jp-card-visa","jp-card-visaelectron","jp-card-elo","jp-card-hipercard"];Card.prototype.defaults={formatting:true,formSelectors:{numberInput:'input[name="number"]',expiryInput:'input[name="expiry"]',cvcInput:'input[name="cvc"]',nameInput:'input[name="name"]'},cardSelectors:{cardContainer:".jp-card-container",card:".jp-card",numberDisplay:".jp-card-number",expiryDisplay:".jp-card-expiry",cvcDisplay:".jp-card-cvc",nameDisplay:".jp-card-name"},messages:{validDate:"valid\nthru",monthYear:"month/year"},placeholders:{number:"&bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull;",cvc:"&bull;&bull;&bull;",expiry:"&bull;&bull;/&bull;&bull;",name:"Full Name"},masks:{cardNumber:false},classes:{valid:"jp-card-valid",invalid:"jp-card-invalid"},debug:false};function Card(a){(this||d).maskCardNumber=bind((this||d).maskCardNumber,this||d);var r;(this||d).options=i(true,(this||d).defaults,a);if((this||d).options.form){(this||d).$el=t((this||d).options.form);if((this||d).options.container){(this||d).$container=t((this||d).options.container);r=t.isDOMElement((this||d).$container)?(this||d).$container:(this||d).$container[0];if(!r.getAttribute((this||d).initializedDataAttr)){r.setAttribute((this||d).initializedDataAttr,true);this.render();this.attachHandlers();this.handleInitialPlaceholders()}}else console.log("Please provide a container")}else console.log("Please provide a form")}Card.prototype.render=function(){var a,r,e,n,s,l,o,c;t.append((this||d).$container,this.template((this||d).cardTemplate,i({},(this||d).options.messages,(this||d).options.placeholders)));s=(this||d).options.cardSelectors;for(e in s){o=s[e];(this||d)["$"+e]=t.find((this||d).$container,o)}l=(this||d).options.formSelectors;for(e in l){o=l[e];o=(this||d).options[e]?(this||d).options[e]:o;n=t.find((this||d).$el,o);!n.length&&(this||d).options.debug&&console.error("Card can't find a "+e+" in your form.");(this||d)["$"+e]=n}if((this||d).options.formatting){Payment.formatCardNumber((this||d).$numberInput);Payment.formatCardCVC((this||d).$cvcInput);Payment.formatCardExpiry((this||d).$expiryInput)}if((this||d).options.width){a=t((this||d).options.cardSelectors.cardContainer)[0];r=parseInt(a.clientWidth||window.getComputedStyle(a).width);a.style.transform="scale("+(this||d).options.width/r+")"}if("undefined"!==typeof navigator&&null!==navigator?navigator.userAgent:void 0){c=navigator.userAgent.toLowerCase();-1!==c.indexOf("safari")&&-1===c.indexOf("chrome")&&t.addClass((this||d).$card,"jp-card-safari")}/MSIE 10\./i.test(navigator.userAgent)&&t.addClass((this||d).$card,"jp-card-ie-10");if(/rv:11.0/i.test(navigator.userAgent))return t.addClass((this||d).$card,"jp-card-ie-11")};Card.prototype.attachHandlers=function(){var r,i;i=[this.validToggler("cardNumber")];(this||d).options.masks.cardNumber&&i.push((this||d).maskCardNumber);a((this||d).$numberInput,(this||d).$numberDisplay,{fill:false,filters:i});t.on((this||d).$numberInput,"payment.cardType",this.handle("setCardType"));r=[function(a){return 1===a.length&&"0"===a[0]?"":a.replace(/(\s+)/g,"")}];r.push(this.validToggler("cardExpiry"));a((this||d).$expiryInput,(this||d).$expiryDisplay,{join:function(a){return 2===a[0].length||a[1]?"/":""},filters:r});a((this||d).$cvcInput,(this||d).$cvcDisplay,{filters:this.validToggler("cardCVC")});t.on((this||d).$cvcInput,"focus",this.handle("flipCard"));t.on((this||d).$cvcInput,"blur",this.handle("unflipCard"));return a((this||d).$nameInput,(this||d).$nameDisplay,{fill:false,filters:this.validToggler("cardHolderName"),join:" "})};Card.prototype.handleInitialPlaceholders=function(){var a,r,i,e;i=(this||d).options.formSelectors;e=[];for(r in i){i[r];a=(this||d)["$"+r];a instanceof NodeList&&(a=a[0]);if(t.val(a)){t.trigger(a,"paste");e.push(function(a){return setTimeout((function(){return t.trigger(a,"keyup")}))}(a))}else e.push(void 0)}return e};Card.prototype.handle=function(a){return function(r){return function(t){var i;i=Array.prototype.slice.call(arguments);i.unshift(t.target);return r.handlers[a].apply(r,i)}}(this||d)};Card.prototype.validToggler=function(a){var r;"cardExpiry"===a?r=function(a){var r;r=Payment.fns.cardExpiryVal(a);return Payment.fns.validateCardExpiry(r.month,r.year)}:"cardCVC"===a?r=function(a){return function(r){return Payment.fns.validateCardCVC(r,a.cardType)}}(this||d):"cardNumber"===a?r=function(a){return Payment.fns.validateCardNumber(a)}:"cardHolderName"===a&&(r=function(a){return""!==a});return function(a){return function(t,i,e){var n;n=r(t);a.toggleValidClass(i,n);a.toggleValidClass(e,n);return t}}(this||d)};Card.prototype.toggleValidClass=function(a,r){t.toggleClass(a,(this||d).options.classes.valid,r);return t.toggleClass(a,(this||d).options.classes.invalid,!r)};Card.prototype.maskCardNumber=function(a,r,t){var i,e;i=(this||d).options.masks.cardNumber;e=a.split(" ");if(e.length>=3){e.forEach((function(a,r){if(r!==e.length-1)return e[r]=e[r].replace(/\d/g,i)}));return e.join(" ")}return a.replace(/\d/g,i)};Card.prototype.handlers={setCardType:function(a,r){var i,e;i=r.data;e=new CustomEvent("card-type-changed",{detail:r.data});document.dispatchEvent(e);if(!t.hasClass((this||d).$card,i)){t.removeClass((this||d).$card,"jp-card-unknown");t.removeClass((this||d).$card,(this||d).cardTypes.join(" "));t.addClass((this||d).$card,"jp-card-"+i);t.toggleClass((this||d).$card,"jp-card-identified","unknown"!==i);return(this||d).cardType=i}},flipCard:function(){return t.addClass((this||d).$card,"jp-card-flipped")},unflipCard:function(){return t.removeClass((this||d).$card,"jp-card-flipped")}};a=function(a,i,e){var n,s,d;null==e&&(e={});e.fill=e.fill||false;e.filters=e.filters||[];e.filters instanceof Array||(e.filters=[e.filters]);e.join=e.join||"";if(!("function"===typeof e.join)){n=e.join;e.join=function(){return n}}d=function(){var a,r,t;t=[];for(a=0,r=i.length;a<r;a++){s=i[a];t.push(s.textContent)}return t}();r(a,i,d,e);t.on(a,"focus",(function(){return t.addClass(i,"jp-card-focused")}));t.on(a,"blur",(function(){return t.removeClass(i,"jp-card-focused")}));t.on(a,"keyup change paste",(function(t){return r(a,i,d,e)}));return a};r=function(a,r,i,e){var n,s,d,l,o,c,p,u,v,f,h,m,j;j=function(){var r,i,e;e=[];for(r=0,i=a.length;r<i;r++){n=a[r];e.push(t.val(n))}return e}();o=e.join(j);j=j.join(o);j===o&&(j="");h=e.filters;for(l=0,p=h.length;l<p;l++){s=h[l];j=s(j,a,r)}m=[];for(d=c=0,u=r.length;c<u;d=++c){v=r[d];f=e.fill?j+i[d].substring(j.length):j||i[d];m.push(v.textContent=f)}return m};Card.prototype.getCardType=function(){var a;a=Payment.fns.cardType((this||d).$numberInput[0].value);return a||"unknown"};return Card}();l=r;d.Card=r}).call(l);var o=l;export default o;

